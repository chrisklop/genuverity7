<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{TITLE}} | GenuVerity</title>
    <meta name="description" content="{{META_DESCRIPTION}}">
    <meta name="keywords" content="{{KEYWORDS}}">
    <meta name="author" content="GenuVerity Intelligence">
    <meta name="robots" content="index, follow, max-image-preview:large">
    <meta name="referrer" content="no-referrer-when-downgrade">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <link rel="icon" type="image/png" href="../favicon.png">
    <link rel="apple-touch-icon" href="../favicon.png">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.genuverity.com/{{SLUG}}">
    <meta property="og:title" content="{{TITLE}} | GenuVerity">
    <meta property="og:description" content="{{META_DESCRIPTION}}">
    <meta property="og:image" content="https://www.genuverity.com/images/thumbnails/{{SLUG}}.webp">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://www.genuverity.com/{{SLUG}}">
    <meta property="twitter:title" content="{{TITLE}} | GenuVerity">
    <meta property="twitter:description" content="{{META_DESCRIPTION}}">
    <meta property="twitter:image" content="https://www.genuverity.com/images/thumbnails/{{SLUG}}.webp">

    <!-- Structured Data (JSON-LD) for NewsArticle -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "headline": "{{TITLE}}",
      "description": "{{META_DESCRIPTION}}",
      "image": ["https://www.genuverity.com/images/thumbnails/{{SLUG}}.webp"],
      "datePublished": "{{PUBLISH_DATE}}",
      "dateModified": "{{PUBLISH_DATE}}",
      "author": {
        "@type": "Organization",
        "name": "GenuVerity",
        "url": "https://www.genuverity.com"
      },
      "publisher": {
        "@type": "Organization",
        "name": "GenuVerity",
        "url": "https://www.genuverity.com",
        "logo": {
          "@type": "ImageObject",
          "url": "https://www.genuverity.com/favicon.png"
        }
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://www.genuverity.com/{{SLUG}}"
      },
      "articleSection": "{{CATEGORY}}",
      "keywords": "{{KEYWORDS}}"
    }
    </script>

    <!-- Dependencies -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../js/chart-watermark.js"></script>
    <script src="../js/chart-defaults.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="../js/copyable-sections.js?v=4.0" defer></script>
    <script src="../js/shared-components.js?v=4.0" defer></script>

    <!-- Fonts (2-Font System: Crimson Pro + Inter) -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Crimson+Pro:ital,wght@0,400;0,600;0,700;1,400&display=swap"
        rel="stylesheet">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../css/shared-components.css?v=4.0">
    <link rel="stylesheet" href="../css/reports.css?v=4.0">
</head>

<body>
    <!-- Shared Navbar Placeholder -->
    <div id="navbar-placeholder" data-page-type="report"></div>

    <div class="container">
        <!-- REPORT HEADER -->
        <div class="report-meta">
            <span class="meta-tag">{{CATEGORY}}</span>
            <span class="meta-tag red">{{SUBCATEGORY}}</span>
            <span class="meta-tag"><i data-lucide="clock"
                    style="width:12px; display:inline-block; vertical-align:middle;"></i> {{READ_TIME}} MIN READ</span>
        </div>

        <h1 class="report-title">{{TITLE}}</h1>
        <h2 class="report-subtitle">{{SUBTITLE}}</h2>

        <!-- MAIN LAYOUT GRID -->
        <div class="content-grid">
            <!-- SIDEBAR: SOURCES FIRST -->
            <aside class="sources-sidebar">
                <!-- Social Sharing Buttons (2x2 grid, transparent buttons, white icons) -->
                <div class="share-section">
                    <div class="share-heading"><i data-lucide="share-2" style="width:18px;"></i>Share This Report</div>
                    <div class="share-buttons">
                        <button onclick="shareToTwitter()" class="share-btn share-twitter">
                            <i data-lucide="twitter"></i> X
                        </button>
                        <button onclick="shareToFacebook()" class="share-btn share-facebook">
                            <i data-lucide="facebook"></i> Facebook
                        </button>
                        <button onclick="shareToLinkedIn()" class="share-btn share-linkedin">
                            <i data-lucide="linkedin"></i> LinkedIn
                        </button>
                        <button onclick="copyShareLink()" class="share-btn share-copy" id="copyLinkBtn">
                            <i data-lucide="link"></i> Copy Link
                        </button>
                    </div>
                </div>

                <!-- Sources header is clickable on mobile to expand/collapse -->
                <div class="sources-header">
                    <div class="sources-title"><i data-lucide="database" style="width:18px;"></i>Sources First</div>
                    <span class="sources-count">{{SOURCE_COUNT}}</span>
                </div>
                <div class="sources-list" id="sourcesList">
                    <!-- {{SOURCE_CARDS}} -->
                    <!-- TEMPLATE FOR EACH SOURCE:
                    <a href="{{SOURCE_URL}}" target="_blank" class="source-card" id="source-{{N}}">
                        <span class="source-ref">{{N}}</span>
                        <div>
                            <div>{{SOURCE_TITLE}}</div>
                            <div style="font-size:0.7em; opacity:0.7;">{{SOURCE_DOMAIN}}</div>
                        </div>
                    </a>
                    -->
                </div>
            </aside>

            <!-- MAIN ARTICLE CONTENT -->
            <article class="article-content">

                <!-- TL;DR VERDICT (Copyable) -->
                <div class="info-box amber copyable-section" id="tldr">
                    <div class="info-title"><i data-lucide="zap"></i>TL;DR</div>
                    <p><strong>{{VERDICT}}</strong></p>
                    <p>{{TLDR_SUMMARY}}</p>
                </div>

                <!-- EXECUTIVE SUMMARY (Copyable) -->
                <div class="info-box copyable-section" id="executive-summary">
                    <div class="info-title"><i data-lucide="file-text"></i>Executive Summary</div>
                    <p>{{EXECUTIVE_SUMMARY}}</p>
                </div>

                <!-- {{ARTICLE_SECTIONS}} -->
                <!-- TEMPLATE FOR EACH SECTION:
                <section class="copyable-section">
                    <h2>{{SECTION_TITLE}}</h2>
                    <p>{{SECTION_CONTENT}} <a href="#source-N" class="citation-link" onclick="highlightSource(event, 'source-N')">[N]</a></p>
                </section>
                -->

                <!-- TEMPLATE FOR CHART (magazine-style, floats right with text wrap):
                <figure class="float-figure copyable-section" id="{{CHART_ID}}-wrapper">
                    <div class="chart-wrapper">
                        <div class="chart-header">
                            <div class="chart-title">{{CHART_TITLE}}</div>
                        </div>
                        <canvas id="{{CHART_ID}}" height="220"></canvas>
                    </div>
                    <figcaption>{{CHART_CAPTION}}</figcaption>
                </figure>
                -->

                <!-- TEMPLATE FOR TABLE:
                <div class="data-table-container copyable-section">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>{{HEADER_1}}</th>
                                <th>{{HEADER_2}}</th>
                                <th>{{HEADER_3}}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>{{CELL_1}}</td>
                                <td>{{CELL_2}}</td>
                                <td>{{CELL_3}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                -->

                <!-- TEMPLATE FOR FIGURE:
                <figure class="float-figure copyable-section" style="float: right; margin: 5px 0 20px 25px;">
                    <img src="{{IMAGE_URL}}" alt="{{IMAGE_ALT}}">
                    <figcaption>
                        <strong style="color:var(--accent-red);">EXHIBIT {{LETTER}}:</strong>
                        {{CAPTION_TEXT}} (Source: {{SOURCE_NAME}})
                    </figcaption>
                </figure>
                -->

                <!-- TEMPLATE FOR ALERT BOX:
                <div class="info-box {{ALERT_COLOR}} copyable-section" style="clear: both;">
                    <div class="info-title"><i data-lucide="{{ALERT_ICON}}"></i>{{ALERT_TITLE}}</div>
                    <p>{{ALERT_CONTENT}}</p>
                </div>
                -->

            </article>
        </div>
    </div>

    <!-- Shared Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <script>
        // Scroll-progress is now handled by shared-components.js
        // DO NOT add scroll listeners here - they will override shared components

        // Initialize Lucide Icons
        window.addEventListener('gv:componentsReady', () => {
            lucide.createIcons();
        });

        // Interactive Citation Highlighting
        function highlightSource(event, id) {
            event.preventDefault();
            const element = document.getElementById(id);

            if (element) {
                element.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
                element.classList.remove('highlight');
                void element.offsetWidth; // trigger reflow
                element.classList.add('highlight');
            }
        }

        // Social Sharing Functions
        function shareToTwitter() {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent(document.title);
            window.open(`https://twitter.com/intent/tweet?url=${url}&text=${text}`, '_blank', 'width=600,height=400');
        }

        function shareToFacebook() {
            const url = encodeURIComponent(window.location.href);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank', 'width=600,height=400');
        }

        function shareToLinkedIn() {
            const url = encodeURIComponent(window.location.href);
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`, '_blank', 'width=600,height=600');
        }

        function copyShareLink() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                const btn = document.getElementById('copyLinkBtn');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<i data-lucide="check"></i> Copied!';
                btn.classList.add('copied');
                lucide.createIcons({ nodes: [btn] });
                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                    btn.classList.remove('copied');
                    lucide.createIcons({ nodes: [btn] });
                }, 2000);
            });
        }


        // {{CHART_JS_CONFIGS}}
        // TEMPLATE FOR CHART CONFIG:
        // new Chart(document.getElementById('{{CHART_ID}}').getContext('2d'), {
        //     type: '{{CHART_TYPE}}',
        //     data: {
        //         labels: [{{LABELS}}],
        //         datasets: [{
        //             label: '{{DATASET_LABEL}}',
        //             data: [{{DATA_VALUES}}],
        //             borderColor: '{{COLOR}}',
        //             backgroundColor: '{{COLOR_ALPHA}}',
        //             fill: true,
        //             tension: 0.2
        //         }]
        //     },
        //     options: {
        //         responsive: true,
        //         plugins: {
        //             legend: {
        //                 display: true,
        //                 labels: { color: '#94a3b8' }
        //             }
        //         },
        //         scales: {
        //             y: {
        //                 display: true,
        //                 grid: { color: 'rgba(255,255,255,0.05)' },
        //                 ticks: { color: '#64748b' }
        //             },
        //             x: {
        //                 grid: { color: 'rgba(255,255,255,0.05)' },
        //                 ticks: { color: '#94a3b8' }
        //             }
        //         }
        //     }
        // });
    </script>
</body>

</html>